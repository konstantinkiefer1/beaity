"use strict";(()=>{var e={};e.id=558,e.ids=[558],e.modules={11185:e=>{e.exports=require("mongoose")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},78185:(e,t,r)=>{r.r(t),r.d(t,{headerHooks:()=>f,originalPathname:()=>N,patchFetch:()=>_,requestAsyncStorage:()=>h,routeModule:()=>v,serverHooks:()=>S,staticGenerationAsyncStorage:()=>O,staticGenerationBailout:()=>y});var o={};r.r(o),r.d(o,{POST:()=>g});var a=r(95419),i=r(69108),s=r(99678),n=r(98984),l=r(22361),p=r(11185),d=r.n(p),u=r(49976);let c=d().Schema({email:{type:String,trim:!0,lowercase:!0,private:!0,required:!0}},{timestamps:!0,toJSON:{virtuals:!0}});c.plugin(u.Z);let m=d().models.Lead||d().model("Lead",c);async function g(e){await (0,l.Z)();let t=await e.json();if(!t.email)return n.NextResponse.json({error:"Email is required"},{status:400});try{return await m.findOne({email:t.email})||await m.create({email:t.email}),n.NextResponse.json({})}catch(e){return console.error(e),n.NextResponse.json({error:e.message},{status:500})}}let v=new a.AppRouteRouteModule({definition:{kind:i.x.APP_ROUTE,page:"/api/lead/route",pathname:"/api/lead",filename:"route",bundlePath:"app/api/lead/route"},resolvedPagePath:"C:\\Coding\\test\\app\\api\\lead\\route.js",nextConfigOutput:"",userland:o}),{requestAsyncStorage:h,staticGenerationAsyncStorage:O,serverHooks:S,headerHooks:f,staticGenerationBailout:y}=v,N="/api/lead/route";function _(){return(0,s.patchFetch)({serverHooks:S,staticGenerationAsyncStorage:O})}},22361:(e,t,r)=>{r.d(t,{Z:()=>i});var o=r(11185),a=r.n(o);r(87786);let i=async()=>{if(!process.env.MONGODB_URI)throw Error("Add the MONGODB_URI environment variable inside .env.local to use mongoose");return a().connect(process.env.MONGODB_URI,{useNewUrlParser:!0,useUnifiedTopology:!0}).catch(e=>console.error("Mongoose Client Error: "+e.message))}},87786:(e,t,r)=>{r.d(t,{Z:()=>n});var o=r(11185),a=r.n(o),i=r(49976);let s=a().Schema({name:{type:String,trim:!0},email:{type:String,trim:!0,lowercase:!0,private:!0},image:{type:String},customerId:{type:String,validate:e=>e.includes("cus_")},priceId:{type:String,validate:e=>e.includes("price_")},hasAccess:{type:Boolean,default:!1}},{timestamps:!0,toJSON:{virtuals:!0}});s.plugin(i.Z);let n=a().models.User||a().model("User",s)},49976:(e,t,r)=>{r.d(t,{Z:()=>a});let o=(e,t,r)=>{if(r===t.length-1){delete e[t[r]];return}o(e[t[r]],t,r+1)},a=e=>{let t;e.options.toJSON&&e.options.toJSON.transform&&(t=e.options.toJSON.transform),e.options.toJSON=Object.assign(e.options.toJSON||{},{transform(r,a,i){if(Object.keys(e.paths).forEach(t=>{e.paths[t].options&&e.paths[t].options.private&&o(a,t.split("."),0)}),a._id&&(a.id=a._id.toString()),delete a._id,delete a.__v,t)return t(r,a,i)}})}}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),o=t.X(0,[638,791],()=>r(78185));module.exports=o})();